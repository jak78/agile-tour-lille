---
layout: conflike
title: Programme
visible: 1
permalink: /conflike/
---

<script type="text/javascript">
  var userID = '';
  
  function UniqueUserID() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
      return v.toString(16);
    });
  }
  
  function initializeUserID() { //called on page load (see layout file)
    if (localStorage.userID != '' && localStorage.userID != undefined) {
      userID = localStorage.userID;
    } else {
      userID = UniqueUserID();
      localStorage.userID = userID;
    }
    document.getElementById('userid').innerHTML=userID;
  }
</script>

<script type="text/javascript">
  function setVote(value, confID){
    document.getElementById(confID + '/vote').innerHTML=value;
    var labels= {"-2": "Pas Super", "-1": "Moyen", "+1": "Bien", "+2": "Très bien"};
    document.getElementById(confID + '/vote/label').innerHTML='(' + labels[value] + ')';
  }
  function setComment(value, confID){
    document.getElementById(confID + '/comment').value=value;
  }  
  function getVote(confID) {
    var vote = document.getElementById(confID + '/vote').innerHTML;
    return vote;
  }
  function getComment(confID) {
    var comment = document.getElementById(confID + '/comment').value;
    if (comment == "") comment = "-"; //Attribute can not be empty with DynamoDB
    return comment;
  }  
  
  function save(confID) {
    var vote = getVote(confID);
    var comment = getComment(confID);
    
    var api_id = '3gwmfohd5g'; 
    var url = 'https://'+ api_id +'.execute-api.eu-west-1.amazonaws.com/prod/ConfLike?userid=' + userID;
    var data = '{"ConfID": { "S": "' + confID + '" }, "UserID": { "S": "' + userID + '" }, "Vote": { "S":"' + vote + '"}, "Comment": { "S": "' + comment + '" }}';
    
    var request = $.ajax({
      url: url,
      method: "POST",
      contentType: "application/json",  
      data: data
    });
 
    request.done(function( msg ) {
    });
     
    request.fail(function( jqXHR, textStatus ) {
      alert( "failed:\n" + JSON.stringify(jqXHR, null, 2));
    });    
  }
  
  function update() { //called on page load (see layout file)
    var api_id = '3gwmfohd5g'; 
    var url = 'https://'+ api_id +'.execute-api.eu-west-1.amazonaws.com/prod/ConfLike?userid=' + userID;

    var request = $.ajax({
      url: url,
      method: "GET"
    });

    request.done(function( response ) {
      var items = response.Items;
      for(var i = 0; i < items.length; i++) {
        var item=items[i];
        var confID=item.ConfID.S;
        setVote(item.Vote.S, confID);
        setComment(item.Comment.S, confID);
      }
    });
     
    request.fail(function( jqXHR, textStatus ) {
      alert( "failed:\n" + JSON.stringify(jqXHR, null, 2));
    });  
  }
</script>

<div class="container">
  <div class="row">    
      <div id="demo-12-col" class="col-xs-12">
          <div class="col-xs-12" style="font-size:24px;padding:15px;text-align:center;background-color:lightgrey;text-decoration:none">AGILE TOUR LILLE 2015</div>
      </div>
  </div>
  
  <div><span>UserID= </span><span id="userid">?</span></div>
  
  <div class="row">    
      <div id="demo-12-col" class="col-xs-12" style="margin:1px">
          <a class="col-xs-12" href="/conflike/#9h15" style="padding:10px;text-align:center;background-color:lightgreen;text-decoration:none">MATIN</a>
     </div>
      <div id="demo-12-col" class="col-xs-12" style="margin:1px">
          <a class="col-xs-12" href="/conflike/#14h00" style="padding:10px;text-align:center;background-color:lightgreen;text-decoration:none">APRES-MIDI</a>
      </div>
  </div>
  
  </br>
  
  <div class="row">
  {% for part in site.data.schedule %}
    {% for slot in part %}
        {% for talk in slot.content %}
            <div class="col-xs-12" id="{{ slot.hour }}" style="margin:1px">
                <div class="col-xs-2" style="text-align:center;">{{ slot.hour }}</div>
                <!--<span>{{ slot.special}}</span>-->
                <div class="col-xs-3" style="text-align:center">{{ talk.room }}</div>
                <a class="col-xs-7" href="/conflike/#{{slot.hour}}_{{ talk.room }}"style="text-align:center;background-color:lightgrey">
                    {{ talk.label }}
                    {{ talk.subject }}
                    </br>
                    ({{ talk.speaker }})
                </a>
            </div>
        {% endfor %}
    {% endfor %}
  {% endfor %}
  </div>

  {% for part in site.data.schedule %}
    {% for slot in part %}
        {% for talk in slot.content %}
        <div id="{{slot.hour}}_{{ talk.room }}" >
          <div style="text-align:center">
            <div class="alert alert-success">{{slot.hour}}_{{ talk.room }}</div>
          </div>    
          <div style="text-align:center">
            <div class="alert alert-success">{{ talk.label }}{{ talk.subject }}</div>
          </div>
          <div style="text-align:center">
            <div class="alert alert-success">{{ talk.speaker }}</div>
          </div>    
          <div style="text-align:center">
            <div class="alert alert-info">Qu'avez vous pensé de cette conférence ?</div>
          </div>
          <div class="btn-group btn-group-justified">
            <div class="btn-group">
              <button type="button" class="btn btn-primary" id="not_great" onclick="setVote('-2', '{{slot.hour}}/{{ talk.room }}');save('{{slot.hour}}/{{ talk.room }}')">
                Pas Super
              </button>
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-primary" id="so_so" onclick="setVote('-1', '{{slot.hour}}/{{ talk.room }}');save('{{slot.hour}}/{{ talk.room }}')">
                Moyen
              </button>
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-primary" id="good" onclick="setVote('+1', '{{slot.hour}}/{{ talk.room }}');save('{{slot.hour}}/{{ talk.room }}')">
                Bien
              </button>
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-primary" id="very_good" onclick="setVote('+2', '{{slot.hour}}/{{ talk.room }}');save('{{slot.hour}}/{{ talk.room }}')">
                Très bien
              </button>
            </div>
          </div>
          <span>Votre Note: </span>
          <span id="{{slot.hour}}/{{ talk.room }}/vote" style="visibility:visible">0</span>
          <span id="{{slot.hour}}/{{ talk.room }}/vote/label" style="visibility:visible">(Pas de note pour le moment)</span>
          <div>Votre commentaire :</div>
          <div class="form-group">
            <textarea class="form-control" rows="5" id="{{slot.hour}}/{{ talk.room }}/comment"></textarea>
            </br>
            <div style="text-align:right">
              <button type="submit" class="btn btn-default" onclick="save('{{slot.hour}}/{{ talk.room }}')">Envoyer Votre Commentaire</button>          
            </div>
          </div>
        </div>
        {% endfor %}
    {% endfor %}
  {% endfor %}
</div>